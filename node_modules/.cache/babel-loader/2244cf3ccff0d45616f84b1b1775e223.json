{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nimport { API_HOST } from '../../consts';\nimport { loadState, removeState, saveState } from '../localStorage';\nconst MATCH_STATE_KEY = 'match';\nconst persistedMatch = loadState(MATCH_STATE_KEY);\nexport const matchSlice = createSlice({\n  name: 'match',\n  initialState: persistedMatch,\n  reducers: {\n    setMatch: (state, action) => action.payload\n  }\n});\nexport const {\n  setMatch\n} = matchSlice.actions;\nexport const getMatch = email => dispatch => {\n  fetch(`${API_HOST}/match/get?email=${email}`, {\n    headers: {\n      'Content-Type': 'application/json'\n    },\n    method: 'GET',\n    body: JSON.stringify({\n      email\n    })\n  }).then(response => response.json()).then(result => {\n    console.log(result.data);\n\n    if (result.status === 'success') {\n      saveState(MATCH_STATE_KEY, result.data.email); // store peer email\n\n      dispatch(setMatch(result.data.email));\n    } else {\n      throw new Error(result.message);\n    }\n  }).catch(err => alert(err));\n};\nexport const endMatch = () => dispatch => {\n  removeState(MATCH_STATE_KEY);\n  dispatch(setMatch(null));\n};\nexport const selectMatch = state => state.match;\nexport default matchSlice.reducer;","map":{"version":3,"sources":["/home/permas/cs3219-ay2021-s1-project-2020-s1-g23/frontend/src/redux/slices/matchSlice.js"],"names":["createSlice","API_HOST","loadState","removeState","saveState","MATCH_STATE_KEY","persistedMatch","matchSlice","name","initialState","reducers","setMatch","state","action","payload","actions","getMatch","email","dispatch","fetch","headers","method","body","JSON","stringify","then","response","json","result","console","log","data","status","Error","message","catch","err","alert","endMatch","selectMatch","match","reducer"],"mappings":"AAAA,SAASA,WAAT,QAA4B,kBAA5B;AACA,SAASC,QAAT,QAAyB,cAAzB;AACA,SAASC,SAAT,EAAoBC,WAApB,EAAiCC,SAAjC,QAAkD,iBAAlD;AAEA,MAAMC,eAAe,GAAG,OAAxB;AACA,MAAMC,cAAc,GAAGJ,SAAS,CAACG,eAAD,CAAhC;AAEA,OAAO,MAAME,UAAU,GAAGP,WAAW,CAAC;AACpCQ,EAAAA,IAAI,EAAE,OAD8B;AAEpCC,EAAAA,YAAY,EAAEH,cAFsB;AAGpCI,EAAAA,QAAQ,EAAE;AACRC,IAAAA,QAAQ,EAAE,CAACC,KAAD,EAAQC,MAAR,KAAmBA,MAAM,CAACC;AAD5B;AAH0B,CAAD,CAA9B;AAQP,OAAO,MAAM;AAAEH,EAAAA;AAAF,IAAeJ,UAAU,CAACQ,OAAhC;AAEP,OAAO,MAAMC,QAAQ,GAAIC,KAAD,IAAYC,QAAD,IAAc;AAC7CC,EAAAA,KAAK,CAAE,GAAElB,QAAS,oBAAmBgB,KAAM,EAAtC,EAAyC;AAC5CG,IAAAA,OAAO,EAAE;AACP,sBAAgB;AADT,KADmC;AAI5CC,IAAAA,MAAM,EAAE,KAJoC;AAK5CC,IAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AAAEP,MAAAA;AAAF,KAAf;AALsC,GAAzC,CAAL,CAOGQ,IAPH,CAOSC,QAAD,IAAcA,QAAQ,CAACC,IAAT,EAPtB,EAQGF,IARH,CAQSG,MAAD,IAAY;AAChBC,IAAAA,OAAO,CAACC,GAAR,CAAYF,MAAM,CAACG,IAAnB;;AACA,QAAIH,MAAM,CAACI,MAAP,KAAkB,SAAtB,EAAiC;AAC/B5B,MAAAA,SAAS,CAACC,eAAD,EAAkBuB,MAAM,CAACG,IAAP,CAAYd,KAA9B,CAAT,CAD+B,CACgB;;AAC/CC,MAAAA,QAAQ,CAACP,QAAQ,CAACiB,MAAM,CAACG,IAAP,CAAYd,KAAb,CAAT,CAAR;AACD,KAHD,MAGO;AACL,YAAM,IAAIgB,KAAJ,CAAUL,MAAM,CAACM,OAAjB,CAAN;AACD;AACF,GAhBH,EAiBGC,KAjBH,CAiBUC,GAAD,IAASC,KAAK,CAACD,GAAD,CAjBvB;AAkBD,CAnBI;AAqBP,OAAO,MAAME,QAAQ,GAAG,MAAOpB,QAAD,IAAc;AAC1Cf,EAAAA,WAAW,CAACE,eAAD,CAAX;AACAa,EAAAA,QAAQ,CAACP,QAAQ,CAAC,IAAD,CAAT,CAAR;AACD,CAHM;AAKP,OAAO,MAAM4B,WAAW,GAAI3B,KAAD,IAAWA,KAAK,CAAC4B,KAArC;AAEP,eAAejC,UAAU,CAACkC,OAA1B","sourcesContent":["import { createSlice } from '@reduxjs/toolkit';\nimport { API_HOST } from '../../consts';\nimport { loadState, removeState, saveState } from '../localStorage';\n\nconst MATCH_STATE_KEY = 'match';\nconst persistedMatch = loadState(MATCH_STATE_KEY);\n\nexport const matchSlice = createSlice({\n  name: 'match',\n  initialState: persistedMatch,\n  reducers: {\n    setMatch: (state, action) => action.payload,\n  },\n});\n\nexport const { setMatch } = matchSlice.actions;\n\nexport const getMatch = (email) => (dispatch) => {\n    fetch(`${API_HOST}/match/get?email=${email}`, {\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      method: 'GET',\n      body: JSON.stringify({ email }),\n    })\n      .then((response) => response.json())\n      .then((result) => {\n        console.log(result.data);\n        if (result.status === 'success') {\n          saveState(MATCH_STATE_KEY, result.data.email); // store peer email\n          dispatch(setMatch(result.data.email));\n        } else {\n          throw new Error(result.message);\n        }\n      })\n      .catch((err) => alert(err));\n  };\n\nexport const endMatch = () => (dispatch) => {\n  removeState(MATCH_STATE_KEY);\n  dispatch(setMatch(null));\n};\n\nexport const selectMatch = (state) => state.match;\n\nexport default matchSlice.reducer;\n"]},"metadata":{},"sourceType":"module"}